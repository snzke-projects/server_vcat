/*!
 * 通用公共方法
 */
$(document).ready(function(){try{$("a").bind("focus",function(){if(this.blur){this.blur()}});$("select").select2();$(".vcat-dialog").each(function(){if(this.id){$("#"+this.id).drap({drapMove:".panel-heading",isLimit:true})}});closeTip();$.ajaxSetup({error:function(b){doError(b);return false}})}catch(a){}});function include(c,m,e){if(document.getElementById(c)==null){var a=typeof e=="string"?[e]:e;for(var f=0;f<a.length;f++){var b=a[f].replace(/^\s|\s$/g,"");var h=b.split(".");var d=h[h.length-1].toLowerCase();var k=d=="css";var l=k?"link":"script";var g=k?" type='text/css' rel='stylesheet' ":" type='text/javascript' ";var j=(k?"href":"src")+"='"+m+b+"'";document.write("<"+l+(f==0?" id="+c:"")+g+j+"></"+l+">")}}}function getQueryString(b,a){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)","i");if(!a||a==""){a=window.location.search}else{a=a.substring(a.indexOf("?"))}r=a.substr(1).match(c);if(r!=null){return unescape(r[2])}return null}function getDictLabel(d,c,a){for(var b=0;b<d.length;b++){var e=d[b];if(e.value==c){return e.label}}return a}function windowOpen(d,c,e,a){var g=parseInt((window.screen.height-a)/2,10),f=parseInt((window.screen.width-e)/2,10),b="location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes,width="+e+",height="+a+",top="+g+",left="+f;window.open(d,c,b)}function resetTip(){top.$.jBox.tip.mess=null}function closeTip(){top.$.jBox.closeTip()}function showTip(d,b,c,a){resetTip();setTimeout(function(){top.$.jBox.tip(d,(b==undefined||b==""?"info":b),{opacity:0,timeout:c==undefined?2000:c})},a==undefined?500:a)}function loading(a){if(a==undefined||a==""){a="正在提交，请稍等..."}resetTip();top.$.jBox.tip(a,"loading",{opacity:0})}function alertx(c,a,b){top.$.jBox.info(c,"提示",{closed:function(){if(typeof a=="function"){a()}},width:b});top.$(".jbox-body .jbox-icon").css("top","55px")}function confirmx(d,b,a,c){top.$.jBox.confirm(d,"系统提示",function(e,g,i){if(e=="ok"){if(typeof b=="function"){b()}else{resetTip();location=b}}},{buttonsFocus:1,closed:function(){if(typeof a=="function"){a()
}},width:c});top.$(".jbox-body .jbox-icon").css("top","55px");return false}function promptx(d,c,b,a){top.$.jBox("<div class='form-search' style='padding:20px;text-align:center;'>"+c+"：<input type='text' id='txt' name='txt'/></div>",{title:d,submit:function(e,g,i){if(i.txt==""){top.$.jBox.tip("请输入"+c+"。","error");return false}if(typeof b=="function"){b()}else{resetTip();location=b+encodeURIComponent(i.txt)}},closed:function(){if(typeof a=="function"){a()}}});return false}function addTabPage(e,a,d,c,b){top.$.fn.jerichoTab.addTab({tabFirer:c,title:e,closeable:d==undefined,data:{dataType:"iframe",dataLink:a}}).loadData(b!=undefined)}function cookie(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+m.path:"";var g=m.domain?"; domain="+m.domain:"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}}function pad(b,c){var a=b.toString().length;while(a<c){b="0"+b;a++}return b}function strToDate(a){return new Date(a.replace(/-/g,"/"))}function addDate(a,b){a=a.valueOf();a=a+b*24*60*60*1000;return new Date(a)}function abbr(a,e){if(!e){e=20}if(a==null||a.length<1){return""}var k=0;var l=0;var d=false;var j=false;var g;for(var f=0;f<a.length;f++){if(f>1&&j==false){d=false}if(f>1&&j==true){d=true}var h=a.charCodeAt(f);if((h>=1&&h<=126)||(65376<=h&&h<=65439)){k++;j=false}else{k+=2;l++;j=true}if(k>e&&f<=a.length-1){if(j==true&&d==true){g=a.substring(0,f-2)+"..."}if(j==false&&d==false){g=a.substring(0,f-3)+"..."}if(j==true&&d==false){g=a.substring(0,f-2)+"..."}if(d==true){g=a.substring(0,f-2)+"..."
}break}}if(k<=e){return a}return g}Date.prototype.pattern=function(a){var d={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};var c={"0":"/u65e5","1":"/u4e00","2":"/u4e8c","3":"/u4e09","4":"/u56db","5":"/u4e94","6":"/u516d"};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}if(/(E+)/.test(a)){a=a.replace(RegExp.$1,((RegExp.$1.length>1)?(RegExp.$1.length>2?"/u661f/u671f":"/u5468"):"")+c[this.getDay()+""])}for(var b in d){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(d[b]):(("00"+d[b]).substr((""+d[b]).length)))}}return a};Date.prototype.addDays=function(a){this.setDate(this.getDate()+a);return this};Date.prototype.addWeeks=function(a){this.addDays(a*7);return this};Date.prototype.addMonths=function(a){var b=this.getDate();this.setMonth(this.getMonth()+a);if(this.getDate()<b){this.setDate(0)}return this};Date.prototype.addYears=function(b){var a=this.getMonth();this.setFullYear(this.getFullYear()+b);if(a<this.getMonth()){this.setDate(0)}return this};function isFunction(a){return"function"===typeof(a)}function isArray(a){return Object.prototype.toString.call(a)==="[object Array]"}function initLayer(){var a="<div id='layerDIV'></div>";$("body").append(a)}function showLayer(a){if($("#layerDIV").length==0){initLayer()}if($("#layerDIV").hasClass("layer")){return}if(isFunction(a)){$("#layerDIV").bind("click",function(){if(a.call(this)){$("#layerDIV").unbind("click")}})}$("#layerDIV").addClass("layer")}function hideLayer(){if($("#layerDIV").length==0){initLayer()}$("#layerDIV").removeClass("layer");return true}function showDialog(b,a){if(undefined==window.dialogIds){window.dialogIds=""}if($("#"+b).is(":hidden")){window.dialogIds+="|"+b;if("string"===typeof(a)){$("#"+b+" .panel-title").text(a);if($("#"+b+" .panel-title .icon-remove").length==0){$("#"+b+" .panel-title").append('<a class="icon-remove pull-right" href="javascript:void(0);" onclick="showDialog($(this).parents(\'.vcat-dialog\').attr(\'id\'))"></a>')
}}showLayer(function(){return hideDialog(b,false)});$("#"+b).center();$("#"+b).show("slow")}else{hideDialog(b,true)}}function hideDialog(d,a){var b=window.dialogIds.split("|");if(b.length==2){window.dialogIds="";$("#"+b[1]).hide("slow");return hideLayer()}if(a){window.dialogIds=window.dialogIds.replace("|"+d,"");$("#"+d).hide("slow")}else{if(b.length>2){var c=b[b.length-1];$("#"+c).hide("slow");window.dialogIds=window.dialogIds.replace("|"+c,"")}}return false}function doError(j){try{if(isNull(j)){return false}top.$.jBox.closeTip();function c(e){e=e.replace(/\r\n/g,"<BR>");e=e.replace(/\n/g,"<BR>");e=e.replace(/\t/g,"<SPAN>　　</SPAN>");e="<SPAN STYLE='COLOR:RED'>"+e+"</SPAN>";return e}if(!isNull(j.responseText)){var d=j.responseText.substring(j.responseText.indexOf("\tat "),j.responseText.indexOf(")"));var i=d.split("(")[0];var m=i.split(".");var n=m[m.length-1];var h=m[m.length-2];var l="Native Method";var k=d.split(":");if(!isNull(k)&&k.length>0){l=k[k.length-1]}var o=j.responseText;if(o.indexOf("java.lang.NullPointerException")>=0&&o.indexOf("java.lang.NullPointerException")<o.indexOf("\tat ")){o="空指针异常！"}else{if(o.indexOf("Exception:")>0){o=o.substring(o.indexOf("Exception:")+10,o.indexOf("\tat "))}}o="程序出现错误，请联系管理员：\r\n\t"+o;if(o.lastIndexOf("\r")!=o.length-1&&o.lastIndexOf("\n")!=o.length-1){o+="\r\n"}o+="错误源自：\r\n\t"+h+" 类 第 "+l+" 行 "+n+" 方法";alertx(c(o),null,700);return false}if(!isNull(j.message)){var d=j.stack.substring(j.stack.indexOf("at "),j.stack.indexOf(")"));var f=d.substring(d.lastIndexOf(".")+1,d.indexOf("(")-1);var a=d.split(":");var b="本页面代码执行出错，请联系管理员：\r\n\t"+j.message;b+="\r\n错误源自：\r\n\t本页面代码第 "+a[a.length-2]+" 行 "+f+" 方法";alertx(c(b),null,700);return false}showLayer();confirmx(c("连接服务器失败，点击【确定】刷新页面！"),location.href,function(){hideLayer()});return false}catch(g){alertx("系统出现错误，请联系管理员：<br><span>　　</span>"+g.message);return false}}String.prototype.toJQS=function(){var a=this;a=a.replace(/:/g,"\\:");a=a.replace(/\./g,"\\.");a=a.replace(/\//g,"\\/");a=a.replace(/\$/g,"\\$");a=a.replace(/\[/g,"\\[");
a=a.replace(/'/g,"\\'");a=a.replace(/"/g,'\\"');a=a.replace(/\*/g,"\\*");return a.replace(/\]/g,"\\]")};function checkNull(c,b){if(isNull(c)||isNull(b)){return true}var a=$("#"+c);if(isNull(a.val())){alertx("请填写"+b+"！",function(){a.focus()});return true}return false}function showViewPage(b,c,a){top.$.jBox.open("iframe:"+b,c,$(top.document).width()-220,$(top.document).height()-180,{buttons:{"确定":true},closed:function(){if(typeof a=="function"){a()}}})}function stopBubble(a){if(a&&a.stopPropagation){a.stopPropagation()}else{window.event.cancelBubble=true}}function datagridAjaxLoader(c,d,a){c.pageNo=c.page;c.pageSize=c.rows;delete c.page;delete c.rows;var b=$(this).datagrid("options");if(!b.url){return false}$.ajax({type:b.method,url:b.url,data:c,dataType:"json",success:function(e){if(!e.rows){e.rows=[]}d(e)},error:function(){a.apply(this,arguments);doError.apply(this,arguments)}})}function getDatagridOption(b){var a={url:"",method:"get",pageSize:20,pageList:[5,10,15,20,25,30,40,50,70,100],fitColumns:false,singleSelect:false,showFooter:false,pagination:true,rownumbers:true,autoRowHeight:false,loader:datagridAjaxLoader};return !isNull(b)?$.extend(a,b):a}function getCheckIdArrayParamString(gridSelector,idFieldName,idParamName){idParamName=idParamName?idParamName:"";var checkedBox=$(gridSelector).datagrid("getChecked");if(checkedBox.length==0){alertx("请勾选目标！");throw new Error("未勾选目标，阻止代码继续执行！")}var orderIdArray=[];$.each(checkedBox,function(index,item){orderIdArray.push(idParamName+"="+eval("item."+idFieldName))});return orderIdArray.join("&")}function getFormParamUrl(a,b){if(!a){return""}if(a.indexOf(ctx)==0){return a}if(!b){b="#searchForm"}return ctx+a+(a.indexOf("?")>0?"":"?")+(a.indexOf("&")>0||a.indexOf("&")>0?"&":"")+$(b).serialize()}function reloadGrid(a,b,c){if(!a){return}a=getFormParamUrl(a,b);if(!c){c="#contentTable"}$(c).datagrid("loadData",{total:0,rows:[]});$(c).datagrid("reload",a)}jQuery.fn.center=function(){this.css("position","absolute");this.css("top",($(window).height()-this.height())/2+$(window).scrollTop()+"px");
this.css("left",($(window).width()-this.width())/2+$(window).scrollLeft()+"px");return this};Number.prototype.toRound=function(j){var h=this+"";if(!j){j=0}if(h.indexOf(".")==-1){h+="."}h+=new Array(j+1).join("0");if(new RegExp("^(-|\\+)?(\\d+(\\.\\d{0,"+(j+1)+"})?)\\d*$").test(h)){var h="0"+RegExp.$2,g=RegExp.$1,e=RegExp.$3.length,c=true;if(e==j+2){e=h.match(/\d/g);if(parseInt(e[e.length-1])>4){for(var f=e.length-2;f>=0;f--){e[f]=parseInt(e[f])+1;if(e[f]==10){e[f]=0;c=f!=1}else{break}}}h=e.join("").replace(new RegExp("(\\d+)(\\d{"+j+"})\\d$"),"$1.$2")}if(c){h=h.substr(1)}return(g+h).replace(/\.$/,"")}return this+""};Number.prototype.add=function(b){var d,c,a;try{d=this.toString().split(".")[1].length}catch(f){d=0}try{c=b.toString().split(".")[1].length}catch(f){c=0}a=Math.pow(10,Math.max(d,c));return(this*a+b*a)/a};Number.prototype.sub=function(a){return this.add(-a)};Number.prototype.mul=function(b){var a=0,d=this.toString(),c=b.toString();try{a+=d.split(".")[1].length}catch(f){}try{a+=c.split(".")[1].length}catch(f){}return Number(d.replace(".",""))*Number(c.replace(".",""))/Math.pow(10,a)};Number.prototype.div=function(arg){var t1=0,t2=0,r1,r2;try{t1=this.toString().split(".")[1].length}catch(e){}try{t2=arg.toString().split(".")[1].length}catch(e){}with(Math){r1=Number(this.toString().replace(".",""));r2=Number(arg.toString().replace(".",""));return(r1/r2)*pow(10,t2-t1)}};function getSizeLabel(a){if(isNull(a)){return"未知大小"}var c=parseInt(a);var b;if(c<1024){b=c+"KB"}if(c>1024*1024){b=c/(1024*1024)+"MB"}return b}function getUrlParam(b,a){var c=new RegExp("(^|&|[?])"+a+"=([^&]*)(&|$)");var d=b.match(c);if(d!=null){return decodeURIComponent(d[2])}return null}function getOpenWindow(){if(top.mainFrame.cmsMainFrame){return top.mainFrame.cmsMainFrame}else{if($(".curholder",parent.document).find("iframe").length>0){return eval("parent.document."+$(".curholder",parent.document).find("iframe").attr("id"))}else{return top.mainFrame}}};